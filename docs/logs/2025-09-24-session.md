# 2025-09-24 작업 로그

## 목표

- Phase 7 자동화(데이터 수집 배치) 구현 및 문서/환경 정리
- Weekly 스크래핑 데이터 구조/문서 불일치 해소
- GitHub Actions 기반 ingest 파이프라인 검증 및 에러 대응

## 수행 내용

- 새 ingest 오케스트레이터 `services/ingest/run_ingest.py` 작성: Daily/Weekly 스크래퍼 실행 → JSON 파싱 → Supabase REST upsert.
- GitHub Actions 워크플로 `ingest-daily.yml`, `ingest-weekly.yml` 추가: cron 스케줄(KST 06:00, 월 08:00) + workflow_dispatch, Python 의존성 설치 후 `run_ingest.py` 실행.
- Supabase 마이그레이션 및 API 로직과 문서 싱크: weekly `thumbnail`/`source` 보존, unified 검색 RPC에 썸네일 노출, Phase 7 FAQ/체크리스트 갱신.
- ingest 스크립트 JSON 파서 개선: scienceON 결과가 JSON 배열로 출력될 때도 처리하도록 수정.
- Vercel/Node 배포 전략 논의: 프론트/백/ingest 분리 배포 방향 정리.
- Hankyung RSS 필터 조정: 블랙리스트 기반으로 기사 제외 로직 단순화, 불필요 키워드(`술` 등)로 인한 false positive 원인 파악

## 비고

- GitHub Actions Secrets(`SUPABASE_URL`, `SUPABASE_SERVICE_KEY`)로 환경 변수 주입 필요, Repository secrets에 등록함.
- Weekly ingest는 scienceON 목록 1페이지 기준 최대 40건 수집(워크플로 인자) → 실행 시간 3~5분 예상.
- 자동화 문서 링크: `docs/phase7_qna.md`에 검색/자동화/온디맨드 운영/데이터 보존 정리, PRD/init-plan에 스케줄러 언급 반영.
- Phase 7 체크리스트에서 “스케줄러 옵션 확정” 항목 완료, CI/배포/관측성 항목은 후속 작업 필요.
